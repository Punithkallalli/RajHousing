<!DOCTYPE html>
<html lang="en">
	<head>
		<title>Raj Housing - City</title>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0">
		<style>
			body {
				margin: 0px;
				background-color: #000000;
				overflow: hidden;
			}
		</style>
	</head>
	<body>

		<script src="js/three.js"></script>
		<script src="js/OrbitControls.js"></script>

		<script>
			var camera, scene, renderer;
			var mesh;
			init();
			animate();
			function init() {
				camera = new THREE.PerspectiveCamera( 70, window.innerWidth / window.innerHeight, 1, 1000 );
				camera.position.z = 100;
				camera.position.y = 100;
				camera.position.x = 50;

				scene = new THREE.Scene();

			    // Init Lights
			    light = new THREE.DirectionalLight( 0xffffff );
			    light.position.set( 50, 50, 50 );
			    // light.target = new THREE.Vector3(0, 0, 0);
			    // light.castShadow = true;
			    scene.add( light );
			    light = new THREE.AmbientLight( 0x666666 );
			    // light.position.set( 5, 5, 0 );
			    // scene.add( light );

			    light = new THREE.SpotLight( 0xffffff, 1, 0, Math.PI / 2 );
				light.position.set( 0, 1500, 1000 );
				light.target.position.set( 0, 0, 0 );
				light.castShadow = true;
				light.shadow = new THREE.LightShadow( new THREE.PerspectiveCamera( 50, 1, 1200, 2500 ) );
				light.shadow.bias = 0.0001;
				light.shadow.mapSize.width = 2000;
				light.shadow.mapSize.height = 1000;
				scene.add( light );

				// Add ground
				var geometry = new THREE.BoxGeometry( 2000, 1, 20000 );
				var material = new THREE.MeshLambertMaterial({color: 0xffffff});
				var ground = new THREE.Mesh( geometry, material );
				ground.receiveShadow = true;
				// ground.castShadow = true;
				ground.position.y = 0;
				scene.add( ground );

			    // Add Buildings
			    // var colors = [ 0xcccc99, 0x99ffff, 0xccccff, 0xcc99cc,  0xffcccc]
			    var colors = [ 0xcccccc, 0x999999, 0x996633, 0x663300];
			    var R = 10, C = 10;
			    for(var i=-R;i<R;i++){
			    	for(var j=-C;j<C;j++){
			    		var h = 70.0*Math.random() + 5;
			    		var c = colors[Math.floor(colors.length*Math.random())];
				    	material = new THREE.MeshPhysicalMaterial({color: c});
			    		geometry = new THREE.BoxGeometry( 10, h, 10 );
			    		var building = new THREE.Mesh( geometry, material );
			    		building.position.x = i*15;
			    		building.position.z = j*15;
			    		building.position.y = h/2;
			    		building.castShadow = true;
			    		building.receiveShadow = true;
			    		scene.add(building);
			    	}
			    }

			    renderer = new THREE.WebGLRenderer();
				renderer.shadowMap.enabled = true;
				renderer.shadowMap.type = THREE.PCFShadowMap;
				renderer.setPixelRatio( window.devicePixelRatio );
				renderer.setSize( window.innerWidth, window.innerHeight );
				document.body.appendChild( renderer.domElement );
				window.addEventListener( 'resize', onWindowResize, false );
				// Init fog
			    scene.fog = new THREE.FogExp2( 0x99ccff, 0.002 );
			    // scene.fog = new THREE.FogExp2( 0xff9933, 0.002 );
			    renderer.setClearColor( scene.fog.color );

				controls = new THREE.OrbitControls ( camera );
				controls.rotateSpeed = 1.0;

			    animate();

			}
			function onWindowResize() {
				camera.aspect = window.innerWidth / window.innerHeight;
				camera.updateProjectionMatrix();
				renderer.setSize( window.innerWidth, window.innerHeight );
			}
			function animate() {
				requestAnimationFrame( animate );
				var rotSpeed = 0.002;
		        var x = camera.position.x;
				var z = camera.position.z;
				camera.position.x = x * Math.cos(rotSpeed) + z * Math.sin(rotSpeed);
				camera.position.z = z * Math.cos(rotSpeed) - x * Math.sin(rotSpeed);
				camera.lookAt(scene.position);
				renderer.render( scene, camera );
			}
		</script>

	</body>
</html>
